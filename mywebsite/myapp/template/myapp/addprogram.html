{% extends 'myapp/base.html' %}
{% load static %}

{% block myheader %}{% endblock myheader %}

{% block content %}
<script src="https://cdn.tailwindcss.com"></script>

<section class="bg-gradient-to-br from-sky-100 via-white to-blue-50 dark:from-gray-900 dark:via-gray-900 dark:to-slate-900">
  <div class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8 lg:py-20">
    <div class="mb-10 flex flex-col gap-4 text-center">
      <span class="mx-auto inline-flex items-center gap-2 rounded-full bg-blue-600/10 px-4 py-1 text-sm font-medium text-blue-700 dark:bg-blue-500/10 dark:text-blue-200">
        Admin dashboard
      </span>
      <h1 class="text-4xl font-bold tracking-tight text-gray-900 dark:text-white sm:text-5xl">Create a new program</h1>
      <p class="mx-auto max-w-2xl text-lg text-gray-600 dark:text-gray-300">
        Define the package details, pricing for each rider type, and upload hero images. All required fields must be completed before publishing.
      </p>
    </div>

    <div class="overflow-hidden rounded-3xl border border-white/60 bg-white/90 shadow-2xl shadow-blue-200/40 backdrop-blur dark:border-white/10 dark:bg-gray-900/80 dark:shadow-blue-900/30">
      <div class="border-b border-blue-100 bg-blue-50 px-6 py-5 dark:border-blue-900/40 dark:bg-blue-900/30">
        <h2 class="text-xl font-semibold text-gray-900 dark:text-white">Program details</h2>
        <p class="text-sm text-gray-600 dark:text-gray-300">Complete the information below and click publish when you are ready.</p>
      </div>
      <div class="px-6 py-6">
        {% if errors %}
        <div class="mb-6 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700 dark:border-red-500/40 dark:bg-red-900/30 dark:text-red-200">
          <p class="font-semibold">Please review the following:</p>
          <ul class="mt-2 list-disc space-y-1 pl-5">
            {% for error in errors %}
            <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}

        {% if success %}
        <div class="mb-6 rounded-xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700 dark:border-emerald-500/40 dark:bg-emerald-900/30 dark:text-emerald-200">
          The program was published successfully.
        </div>
        {% endif %}

        <form id="add-program-form" method="post" enctype="multipart/form-data" class="space-y-8">
          {% csrf_token %}
          <div class="grid gap-6 md:grid-cols-2">
            <div class="space-y-2">
              <label for="code" class="text-sm font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300">Program code*</label>
              <input type="text" id="code" name="code" value="{{ form_values.code }}" class="block w-full rounded-xl border border-gray-200 px-4 py-3 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white" placeholder="ATV-A100" required />
            </div>
            <div class="space-y-2">
              <label for="name" class="text-sm font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300">Program name*</label>
              <input type="text" id="name" name="name" value="{{ form_values.name }}" class="block w-full rounded-xl border border-gray-200 px-4 py-3 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white" placeholder="Sunset Jungle Trek" required />
            </div>
          </div>

          <div class="grid gap-6 md:grid-cols-2">
            <div class="space-y-2">
              <label for="duration_minutes" class="text-sm font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300">Duration (minutes)*</label>
              <input type="number" min="10" step="5" id="duration_minutes" name="duration_minutes" value="{{ form_values.duration_minutes }}" class="block w-full rounded-xl border border-gray-200 px-4 py-3 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white" required />
            </div>
            <div class="flex items-center gap-3 rounded-2xl border border-gray-200 bg-gray-50 px-4 py-3 dark:border-gray-700 dark:bg-gray-800">
              <input type="checkbox" id="active" name="active" value="yes" {% if form_values.active %}checked{% endif %} class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:checked:bg-blue-500" />
              <label for="active" class="text-sm font-medium text-gray-700 dark:text-gray-200">Mark as active/visible</label>
            </div>
          </div>

          <div class="space-y-2">
            <label for="description" class="text-sm font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300">Description*</label>
            <textarea id="description" name="description" rows="5" class="block w-full rounded-xl border border-gray-200 px-4 py-3 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white" placeholder="Describe the trail, duration, highlights, and what riders should expect." required>{{ form_values.description }}</textarea>
          </div>

          <div class="rounded-3xl border border-gray-200 bg-gray-50 px-5 py-6 dark:border-gray-700 dark:bg-gray-800">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Pricing</h3>
            <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">Enter per-person rates for each rider/passenger type. Leave blank if a combination is not offered.</p>
            <div class="mt-4 grid gap-4 md:grid-cols-2">
              {% for field in rate_fields %}
              <div class="space-y-2">
                <label for="{{ field.field }}" class="text-sm font-medium text-gray-600 dark:text-gray-300">{{ field.label }}</label>
                <input type="number" step="0.01" min="0" id="{{ field.field }}" name="{{ field.field }}" value="{{ field.value }}" class="block w-full rounded-xl border border-gray-200 px-4 py-3 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white" placeholder="0" />
              </div>
              {% endfor %}
            </div>
          </div>

          <div class="space-y-3">
            <label for="images" class="text-sm font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300">Program gallery*</label>
            <input type="file" id="images" name="images" accept="image/*" multiple class="block w-full cursor-pointer rounded-xl border border-dashed border-gray-300 bg-white px-4 py-3 text-sm text-gray-600 shadow-sm transition hover:border-blue-400 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300" />
            <p class="text-xs text-gray-500 dark:text-gray-400">Upload one or more high-resolution images. First image becomes the hero shot.</p>
          </div>

          <div class="flex flex-wrap items-center justify-end gap-3">
            <a href="{% url 'home' %}" class="inline-flex items-center rounded-xl border border-gray-200 px-4 py-2 text-sm font-medium text-gray-700 transition hover:bg-gray-100 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800">
              Cancel
            </a>
            <button type="submit" class="inline-flex items-center rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-5 py-2.5 text-sm font-semibold text-white shadow-lg shadow-blue-600/40 transition hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-blue-300 dark:focus:ring-blue-700">
              Publish program
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>
{% endblock content %}
